@page "/admin/"
@using Bastilia.Rating.Portal.Client.Components.Projects
@using Microsoft.Extensions.Options
@inject IOptions<PasswordOptions> options

<h3>Админка</h3>
<Card>
    <Header>Пароли проектов</Header>
    <Body>
        <form method="post" @formname="AdminPasswordForm">
            <AntiforgeryToken />
            <label for="pass">Пароль:</label>
            <input type="password" name="password" id="pass" />
            <input type="submit" value="Перейти" />
        </form>
    </Body>
</Card>

@if(passwordCorrect == true)
{
    <ProjectPasswordGrid />
}

@code {
    [SupplyParameterFromForm(FormName = "AdminPasswordForm")]
    private string? Password { get; set; }

    private bool? passwordCorrect = null;

    protected override async Task OnParametersSetAsync()
    {
        if (Password == options.Value.ProjectPassword)
        {
            passwordCorrect = true;
        }
        else if (Password != null)
        {
            passwordCorrect = false;
        }
        base.OnParametersSet();
    }

}
