@using Bastilia.Rating.Domain
@using Microsoft.AspNetCore.Components.QuickGrid

<QuickGrid Items="Projects" Class="table table-striped" Virtualize="false">
    <TemplateColumn Context="project" Title="Название проекта" SortBy="@projectNameSort">
        <ProjectLink Project="@project" />
    </TemplateColumn>
    @if (ShowYear)
    {
        <TemplateColumn Context="project" IsDefaultSortColumn="true" InitialSortDirection="SortDirection.Descending" SortBy="@projectEndSort">
            @project.EndDate?.Year
        </TemplateColumn>
    }
    <TemplateColumn Context="project" Title="Тип">
        <ProjectTypeBadge Type="project.ProjectType" />
    </TemplateColumn>
    <TemplateColumn Context="project" Title="Бренд">
        <BrandBadge Type="project.BrandType" />
    </TemplateColumn>
    @if (Projects.Any(x => x.HelpRequired))
    {
        <TemplateColumn Context="project" Title="Вписаться?" SortBy="GridSort<BastiliaProject>.ByAscending(p => p.HelpRequired)">
           <HelpRequiredBadge HowToHelp="@project.HowToHelp"/>
        </TemplateColumn>
    }
    <TemplateColumn Context="project" Title="Глава/Координатор">
        @foreach (var user in project.Coordinators)
        {
            <text><BastiliaUserLink Member="@user" /> &nbsp;</text>
        }
    </TemplateColumn>
    <TemplateColumn Context="project" Title="Ссылки">
        <ProjectLinks Project="project" />
    </TemplateColumn>
</QuickGrid>

@code {
    [Parameter, EditorRequired]
    public IQueryable<BastiliaProject> Projects { get; set; }

    [Parameter]
    public bool ShowYear { get; set; }

    GridSort<BastiliaProject> projectNameSort = GridSort<BastiliaProject>
       .ByDescending(x => x.ProjectName);

    GridSort<BastiliaProject> projectEndSort = GridSort<BastiliaProject>.ByAscending(x => x.EndDate);

}

