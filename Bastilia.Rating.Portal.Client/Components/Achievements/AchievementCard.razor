@using System.Globalization
<div class="card h-100" style="margin:0.5em; width:30em">
    <div class="card-body">
        <div>
            <img src="@avatar" width="70" height="70" style="float: left; margin-right:1em; border:1px solid"/>
                <h5 style="padding: 1em">
                    @if (ShowAsProject)
                    {
                        <BastiliaUserLink Member="@Achievement.User" />
                    }
                    else
                    {
                        @Achievement.AchievementName
                    }
                    @if (Achievement.RatingForDisplay is not null)
                    {
                        <span class="text-muted"> (+@CountHelper.DisplayCount(Achievement.RatingForDisplay.Value, "очко", "очка", "очков"))</span>
                    }
                </h5>
        </div>
        <p class="card-text" style="clear: both; margin-top:1em":>@Achievement.Description</p>
        
            <div class="text-muted" style="text-align: right; font-size: 70%">
            @if (Achievement.ProjectLink is not null && !ShowAsProject)
            {
                <ProjectLink Project="Achievement.ProjectLink" />
            }
            else
            {
                <span>Выдал(а) <BastiliaUserLink Member="Achievement.GrantedBy" /></span>
            }
            </div>

        @if (Achievement.RemoveDate is not null)
        {
            <div class="text-muted" style="text-align: right; font-size: 70%">
                Удалено
            </div>
        }
        else if (Achievement.IsExpired)
        {

            <div class="text-muted" style="text-align: right; font-size: 70%">
                Истекло @Achievement.ExpirationDate!.Value.ToShortDateString()
            </div>
        }
        else if (Achievement.ExpirationDate is not null)
        {

            <div class="text-muted" style="text-align: right; font-size: 70%">
                До @Achievement.ExpirationDate.Value.ToShortDateString()
            </div>
        }
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public MemberAchievement Achievement { get; set; } = null!;

    [Parameter]
    public bool ShowValue {get;set;} = false;
    [Parameter]
    public bool ShowAsProject { get; set; }

    private string GrantedDate =>
        Achievement.GrantedDate.ToString("d MMM yyyy", CultureInfo.GetCultureInfo("ru-RU"));

    private string avatar => ShowAsProject ? Achievement.UserAvatar.AbsoluteUri : Achievement.AchievementIconUri.AbsoluteUri;




}